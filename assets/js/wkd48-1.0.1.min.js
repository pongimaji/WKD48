var detail="";let apiKey="AIzaSyA6tE5WtKuHfH1N7HT9r4_qBd8Zcx23fGg",spreadsheetId="1HRjXiyVwZcMbWFRUv7PRz6hgS6lfhChHSnLfwaSbzdI",urlBase="https://sheets.googleapis.com/v4/spreadsheets/";const mobileNavShow=document.querySelector(".mobile-nav-show"),mobileNavHide=document.querySelector(".mobile-nav-hide");function mobileNavToogle(){document.querySelector("body").classList.toggle("mobile-nav-active"),mobileNavShow.classList.toggle("d-none"),mobileNavHide.classList.toggle("d-none")}function generateURL(e,a,n,t,i){return e+a+"/values/"+encodeURIComponent(t)+"!"+i+"?key="+n}function convertCurrencyToInt(e){return parseInt(e.replace(/[^\d]/g,""))}function formatRupiah(e){var a=e.toLocaleString("id-ID",{style:"currency",currency:"IDR"});return a.replace(",00","")}function loadContent(e,a=""){detail=a,$(".nav-link").removeClass("active"),$('.nav-link[data-page="'+e+'"]').addClass("active"),$.get("modul/page-"+e+".html",function(e){$("#wkd48-content").html(e)})}function generateSeasonMenu(e,a,n){$.ajax({url:e+a+"?fields=sheets.properties.title&key="+n,dataType:"json",success:function(e){for(var a=e.sheets,n=[],t=0;t<a.length;t++){var i=a[t].properties.title;n.push(i),$("#submenu-rekap").append('<li><a href="javascript:" class="menus" onclick="loadContent(\'rekap\',\''+i+"')\">"+i+"</a></li>"),$("#submenu-galeri").append('<li><a href="javascript:" class="menus" onclick="loadContent(\'galeri\',\''+i+"')\">"+i+"</a></li>")}},error:function(e,a,n){console.error("Error:",n)}})}function generateImageHome(){for(var e=1;e<=8;e++){var a='<div class="col-xl-3 col-lg-4 col-md-6"><div class="gallery-item h-100"><img src="assets/lagaleria/GALERIA-'+e+'.jpg" class="img-fluid" alt=""><div class="gallery-links d-flex align-items-center justify-content-center"><a href="assets/lagaleria/GALERIA-'+e+'.jpg" title="Dokumentasi Kegiatan" class="glightbox preview-link"><i class="bi bi-arrows-fullscreen"></i></a></div></div></div>';$("#image-container").append(a)}GLightbox({selector:".glightbox"})}function generateImageGaleria(e,a,n,t){let i=generateURL(e,a,n,t,"R3:R42"),r="https://firebasestorage.googleapis.com/v0/b/wkd48-af4e6.appspot.com/o/";$.ajax({url:i,dataType:"json",success:function(e){var a=$("#image-container");a.empty(),$.each(e.values,function(e,n){if(""!=n[0]){var t='<div class="col-xl-3 col-lg-4 col-md-6"><div class="gallery-item h-100"><img src="'+r+n[0]+'" class="img-fluid" alt=""><div class="gallery-links d-flex align-items-center justify-content-center"><a href="'+r+n[0]+'" title="Dokumentasi Kegiatan" class="glightbox preview-link"><i class="bi bi-arrows-fullscreen"></i></a></div></div></div>';a.append(t)}}),GLightbox({selector:".glightbox"})},error:function(e,a,n){console.error("Error:",n)}})}function getSeasonInformasi(e,a,n,t){let i=generateURL(e,a,n,t,"B3:B11");$.ajax({url:i,dataType:"json",success:function(t){var i=[];$.each(t.values,function(e,a){""!=a[0]&&i.push(a[0])}),"Active"==i[8]?($(".season_description").html('Saat ini <b> Program Rp. 10.000 Menguasai Dunia Bersama WKD48 - <span class="text-warning">'+detail+'</span></b> sedang berlangsung. Untuk melihat detail Rekapannya dapat dilihat di <a href="https://pongimaji.github.io/WKD48-RAWR" target="_BLANK"><b>WKD48 ACTIVE REKAP</b></a>'),$("#data-detail").attr("hidden",!0)):($(".season_description").html('Pada halaman ini anda dapat melihat rekap terkait pelaksanaan <b> Program Rp. 10.000 Menguasai Dunia Bersama WKD48 - <span class="text-warning">'+detail+"</span></b>"),$("#data-detail").attr("hidden",!1),$(".str_peserta").html(i[7]+" Peserta"),$(".str_donasipeserta").html(i[3]),$(".str_donasinonpeserta").html(i[4]),$(".str_terkumpul").html(i[5]),$(".str_durasi").html(i[2]),$(".str_periode").html(i[1]),getSeasonPemasukan(e,a,n,detail),getSeasonPemakaianDana(e,a,n,detail),getOrangBaik(e,a,n,detail))},error:function(e,a,n){console.error("Error:",n)}})}function getSeasonPemasukan(e,a,n,t){let i=generateURL(e,a,n,t,"H3:J52");$.ajax({url:i,dataType:"json",success:function(e){var a=$("#data-pemasukan");a.empty(),$.each(e.values,function(e,n){if(""!=n[0]){var t='<li><i class="bi bi-chevron-right"></i> <strong><span class="text-success">'+n[0]+"</span></strong> -<span>"+n[1]+'</span> : <strong><span class="text-warning">'+n[2]+"</span></strong></li>";a.append(t)}})},error:function(e,a,n){console.error("Error:",n)}})}function getSeasonPemakaianDana(e,a,n,t){let i=generateURL(e,a,n,t,"M3:O52");$.ajax({url:i,dataType:"json",success:function(e){var a=0,n=$("#data-pemanfaatandana");n.empty(),$.each(e.values,function(e,t){""!=t[0]&&(a+=convertCurrencyToInt(t[2]),n.append(n.append("<li><strong>"+t[0]+"</strong> <span>"+t[1]+'</span><span class="text-warning">'+t[2]+"</span></li>")))}),n.append('<li><b>Total Pemanfaatan dana:</b> <b class="text-warning" style="font-size:24px;">'+formatRupiah(a)+"</b></li>")},error:function(e,a,n){console.error("Error:",n)}})}function getOrangBaik(e,a,n,t){let i=generateURL(e,a,n,t,"E3:E62");$.ajax({url:i,dataType:"json",success:function(e){var a=$("#data-orangbaik");a.empty(),$.each(e.values,function(e,n){if(""!=n[0]){var t='<div class="col-lg-3"><div class="pricing-item d-flex justify-content-between"><h3>'+n[0]+"</h3></div></div>";a.append(t)}})},error:function(e,a,n){console.error("Error:",n)}})}document.querySelectorAll(".mobile-nav-toggle").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),mobileNavToogle()})}),$(document).ready(function(){loadContent("home"),generateSeasonMenu(urlBase,spreadsheetId,apiKey),$(".menus").on("click",function(){mobileNavToogle()})});