var detail="",firstload=!0;let apiKey="AIzaSyBJLYKczUPmd2Q9t1QRzP0elQfIjA-LCWs",spreadsheetId="1HRjXiyVwZcMbWFRUv7PRz6hgS6lfhChHSnLfwaSbzdI",urlBase="https://sheets.googleapis.com/v4/spreadsheets/";const mobileNavShow=document.querySelector(".mobile-nav-show"),mobileNavHide=document.querySelector(".mobile-nav-hide");function mobileNavToogle(){document.querySelector("body").classList.toggle("mobile-nav-active"),mobileNavShow.classList.toggle("d-none"),mobileNavHide.classList.toggle("d-none")}function generateURL(a,e,n,t,s){return a+e+"/values/"+encodeURIComponent(t)+"!"+s+"?key="+n}function convertCurrencyToInt(a){return parseInt(a.replace(/[^\d]/g,""))}function formatRupiah(a){var e=a.toLocaleString("id-ID",{style:"currency",currency:"IDR"});return e.replace(",00","")}function loadContent(a,e=""){detail=e,$(".nav-link").removeClass("active"),$('.nav-link[data-page="'+a+'"]').addClass("active"),$.get("modul/page-"+a+".html",function(a){$("#wkd48-content").html(a),!1===firstload&&mobileNavToogle()})}function generateSeasonMenu(a,e,n){$.ajax({url:a+e+"?fields=sheets.properties.title&key="+n,dataType:"json",success:function(a){for(var e=a.sheets,n=[],t=0;t<e.length;t++){var s=e[t].properties.title;n.push(s),$("#submenu-rekap").append('<li><a href="javascript:" class="menus" onclick="loadContent(\'rekap\',\''+s+"')\">"+s+"</a></li>"),$("#submenu-galeri").append('<li><a href="javascript:" class="menus" onclick="loadContent(\'galeri\',\''+s+"')\">"+s+"</a></li>")}},error:function(a,e,n){console.error("Error:",n)}})}function generateImageHome(){for(var a=1;a<=8;a++){var e='<div class="col-xl-3 col-lg-4 col-md-6"><div class="gallery-item h-100"><img src="assets/lagaleria/GALERIA-'+a+'.jpg" class="img-fluid" alt=""><div class="gallery-links d-flex align-items-center justify-content-center"><a href="assets/lagaleria/GALERIA-'+a+'.jpg" title="Dokumentasi Kegiatan" class="glightbox preview-link"><i class="bi bi-arrows-fullscreen"></i></a></div></div></div>';$("#image-container").append(e)}GLightbox({selector:".glightbox"})}function generateImageGaleria(a,e,n,t){let s=generateURL(a,e,n,t,"R3:R42"),r="https://firebasestorage.googleapis.com/v0/b/wkd48-af4e6.appspot.com/o/";$.ajax({url:s,dataType:"json",success:function(a){var e=$("#image-container");e.empty(),$.each(a.values,function(a,n){if(""!=n[0]){var t='<div class="col-xl-3 col-lg-4 col-md-6"><div class="gallery-item h-100"><img src="'+r+n[0]+'" class="img-fluid" alt=""><div class="gallery-links d-flex align-items-center justify-content-center"><a href="'+r+n[0]+'" title="Dokumentasi Kegiatan" class="glightbox preview-link"><i class="bi bi-arrows-fullscreen"></i></a></div></div></div>';e.append(t)}}),GLightbox({selector:".glightbox"})},error:function(a,e,n){console.error("Error:",n)}})}function getSeasonInformasi(a,e,n,t){let s=generateURL(a,e,n,t,"B3:B11");$.ajax({url:s,dataType:"json",success:function(t){var s=[];$.each(t.values,function(a,e){""!=e[0]&&s.push(e[0])}),"Active"==s[8]?($(".season_description").html('Mohon maaf <b> Program Rp. 10.000 Menguasai Dunia Bersama WKD48 - <span class="text-warning">'+detail+"</span></b> masih sedang berjalan sehingga saat ini informasi detailnya belum dapat kami sajikan."),$("#data-detail").attr("hidden",!0)):($(".season_description").html('Pada halaman ini anda dapat melihat rekap terkait pelaksanaan <b> Program Rp. 10.000 Menguasai Dunia Bersama WKD48 - <span class="text-warning">'+detail+"</span></b>"),$("#data-detail").attr("hidden",!1),$(".str_peserta").html(s[7]+" Peserta"),$(".str_donasipeserta").html(s[3]),$(".str_donasinonpeserta").html(s[4]),$(".str_terkumpul").html(s[5]),$(".str_durasi").html(s[2]),$(".str_periode").html(s[1]),getSeasonPemasukan(a,e,n,detail),getSeasonPemakaianDana(a,e,n,detail),getOrangBaik(a,e,n,detail))},error:function(a,e,n){console.error("Error:",n)}})}function getSeasonPemasukan(a,e,n,t){let s=generateURL(a,e,n,t,"H3:J52");$.ajax({url:s,dataType:"json",success:function(a){var e=$("#data-pemasukan");e.empty(),$.each(a.values,function(a,n){if(""!=n[0]){var t='<li><i class="bi bi-chevron-right"></i> <strong><span class="text-success">'+n[0]+"</span></strong> -<span>"+n[1]+'</span> : <strong><span class="text-warning">'+n[2]+"</span></strong></li>";e.append(t)}})},error:function(a,e,n){console.error("Error:",n)}})}function getSeasonPemakaianDana(a,e,n,t){let s=generateURL(a,e,n,t,"M3:O52");$.ajax({url:s,dataType:"json",success:function(a){var e=0,n=$("#data-pemanfaatandana");n.empty(),$.each(a.values,function(a,t){""!=t[0]&&(e+=convertCurrencyToInt(t[2]),n.append(n.append("<li><strong>"+t[0]+"</strong> <span>"+t[1]+'</span><span class="text-warning">'+t[2]+"</span></li>")))}),n.append('<li><b>Total Pemanfaatan dana:</b> <b class="text-warning" style="font-size:24px;">'+formatRupiah(e)+"</b></li>")},error:function(a,e,n){console.error("Error:",n)}})}function getOrangBaik(a,e,n,t){let s=generateURL(a,e,n,t,"E3:E62");$.ajax({url:s,dataType:"json",success:function(a){var e=$("#data-orangbaik");e.empty(),$.each(a.values,function(a,n){if(""!=n[0]){var t='<div class="col-lg-3"><div class="pricing-item d-flex justify-content-between"><h3>'+n[0]+"</h3></div></div>";e.append(t)}})},error:function(a,e,n){console.error("Error:",n)}})}document.querySelectorAll(".mobile-nav-toggle").forEach(a=>{a.addEventListener("click",function(a){a.preventDefault(),mobileNavToogle()})}),$(document).ready(function(){loadContent("home"),generateSeasonMenu(urlBase,spreadsheetId,apiKey),firstload=!1});
